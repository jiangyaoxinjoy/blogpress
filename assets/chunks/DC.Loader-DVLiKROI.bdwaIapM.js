import{e as s}from"./namespace-BzafXSza.D48SLZaH.js";import{v as d,o as p,l as y}from"./DC.Billboard-PmQQ7euw.ChfjaA3c.js";const v="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");DC.Util=class{static uuid(e="D"){let t=[];t[8]=t[13]=t[18]=t[23]="-",t[14]="4";let i;for(let r=0;r<36;r++)t[r]||(i=0|Math.random()*16,t[r]=v[r==19?i&3|8:i]);return e+"-"+t.join("")}static merge(e,...t){let i,r,a,n;for(r=0,a=t.length;r<a;r++){n=t[r];for(i in n)e[i]=n[i]}return e}static trim(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}static splitWords(e){return this.trim(e).split(/\s+/)}};DC.DomUtil=class{static create(e,t,i){var r=document.createElement(e);return r.className=t||"",i&&i.appendChild(r),r}static remove(e){var t=e.parentNode;t&&t.removeChild(e)}static empty(e){for(;e.firstChild;)e.removeChild(e.firstChild)}static addClass(e,t){if(e.classList!==void 0){let i=DC.Util.splitWords(t);for(let r=0,a=i.length;r<a;r++)e.classList.add(i[r])}else if(!this.hasClass(e,t)){let i=this.getClass(e);this.setClass(e,(i?i+" ":"")+t)}}static removeClass(e,t){e.classList!==void 0?e.classList.remove(t):this.setClass(e,DC.Util.trim((" "+this.getClass(e)+" ").replace(" "+t+" "," ")))}static setClass(e,t){e.className.baseVal===void 0?e.className=t:e.className.baseVal=t}static getClass(e){return e.correspondingElement&&(e=e.correspondingElement),e.className.baseVal===void 0?e.className:e.className.baseVal}};const _=3.141592653589793*3e3/180,l=3.141592653589793,u=6378245,m=.006693421622965943;DC.CoordTransform=class{static BD09ToGCJ02(e,t){let i=+e-.0065,r=+t-.006,a=Math.sqrt(i*i+r*r)-2e-5*Math.sin(r*_),n=Math.atan2(r,i)-3e-6*Math.cos(i*_),o=a*Math.cos(n),h=a*Math.sin(n);return[o,h]}static GCJ02ToBD09(e,t){t=+t,e=+e;let i=Math.sqrt(e*e+t*t)+2e-5*Math.sin(t*_),r=Math.atan2(t,e)+3e-6*Math.cos(e*_),a=i*Math.cos(r)+.0065,n=i*Math.sin(r)+.006;return[a,n]}static WGS84ToGCJ02(e,t){if(t=+t,e=+e,this.out_of_china(e,t))return[e,t];{let i=this.delta(e,t);return[e+i[0],t+i[1]]}}static GCJ02ToWGS84(e,t){if(t=+t,e=+e,this.out_of_china(e,t))return[e,t];{let i=this.delta(e,t),r=e+i[0],a=t+i[1];return[e*2-r,t*2-a]}}static delta(e,t){let i=this.transformLng(e-105,t-35),r=this.transformLat(e-105,t-35);const a=t/180*l;let n=Math.sin(a);n=1-m*n*n;const o=Math.sqrt(n);return i=i*180/(u/o*Math.cos(a)*l),r=r*180/(u*(1-m)/(n*o)*l),[i,r]}static transformLng(e,t){t=+t,e=+e;let i=300+e+2*t+.1*e*e+.1*e*t+.1*Math.sqrt(Math.abs(e));return i+=(20*Math.sin(6*e*l)+20*Math.sin(2*e*l))*2/3,i+=(20*Math.sin(e*l)+40*Math.sin(e/3*l))*2/3,i+=(150*Math.sin(e/12*l)+300*Math.sin(e/30*l))*2/3,i}static transformLat(e,t){t=+t,e=+e;let i=-100+2*e+3*t+.2*t*t+.1*e*t+.2*Math.sqrt(Math.abs(e));return i+=(20*Math.sin(6*e*l)+20*Math.sin(2*e*l))*2/3,i+=(20*Math.sin(t*l)+40*Math.sin(t/3*l))*2/3,i+=(160*Math.sin(t/12*l)+320*Math.sin(t*l/30))*2/3,i}static out_of_china(e,t){return t=+t,e=+e,!(e>73.66&&e<135.05&&t>3.86&&t<53.55)}};class w extends s.WebMercatorTilingScheme{constructor(t){super(t);let i=new s.WebMercatorProjection;this._projection.project=function(r,a){return a=DC.CoordTransform.WGS84ToGCJ02(s.Math.toDegrees(r.longitude),s.Math.toDegrees(r.latitude)),a=i.project(new s.Cartographic(s.Math.toRadians(a[0]),s.Math.toRadians(a[1]))),new s.Cartesian2(a.x,a.y)},this._projection.unproject=function(r,a){let n=i.unproject(r);return a=DC.CoordTransform.GCJ02ToWGS84(s.Math.toDegrees(n.longitude),s.Math.toDegrees(n.latitude)),new s.Cartographic(s.Math.toRadians(a[0]),s.Math.toRadians(a[1]))}}}const E="https://webst{s}.is.autonavi.com/appmaptile?style=6&x={x}&y={y}&z={z}",f="http://webrd{s}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=7&x={x}&y={y}&z={z}";class D extends s.UrlTemplateImageryProvider{constructor(t={}){DC.Util.merge(t,{format:"image/jpeg",tileMatrixSetID:"GoogleMapsCompatible",maximumLevel:18}),t.url=t.style==="img"?E:f,t.subdomains||(t.subdomains=["01","02","03","04"]),t.crs==="WGS84"&&(t.tilingScheme=new w),super(t)}}const T="http://api{s}.map.bdimg.com/customimage/tile?&x={x}&y={y}&z={z}&scale=1&customid={style}";class b{constructor(t={}){this._url=T,this._tileWidth=256,this._tileHeight=256,this._maximumLevel=18,this._tilingScheme=new s.WebMercatorTilingScheme({rectangleSouthwestInMeters:new s.Cartesian2(-33554054,-33746824),rectangleNortheastInMeters:new s.Cartesian2(33554054,33746824)}),this._rectangle=this._tilingScheme.rectangle,this._credit=void 0,this._style=t.style||"normal"}get url(){return this._url}get token(){return this._token}get tileWidth(){if(!this.ready)throw new s.DeveloperError("tileWidth must not be called before the imagery provider is ready.");return this._tileWidth}get tileHeight(){if(!this.ready)throw new s.DeveloperError("tileHeight must not be called before the imagery provider is ready.");return this._tileHeight}get maximumLevel(){if(!this.ready)throw new s.DeveloperError("maximumLevel must not be called before the imagery provider is ready.");return this._maximumLevel}get minimumLevel(){if(!this.ready)throw new s.DeveloperError("minimumLevel must not be called before the imagery provider is ready.");return 0}get tilingScheme(){if(!this.ready)throw new s.DeveloperError("tilingScheme must not be called before the imagery provider is ready.");return this._tilingScheme}get rectangle(){if(!this.ready)throw new s.DeveloperError("rectangle must not be called before the imagery provider is ready.");return this._rectangle}get ready(){return!!this._url}get credit(){return this._credit}getTileCredits(t,i,r){}requestImage(t,i,r){if(!this.ready)throw new s.DeveloperError("requestImage must not be called before the imagery provider is ready.");let a=this._tilingScheme.getNumberOfXTilesAtLevel(r),n=this._tilingScheme.getNumberOfYTilesAtLevel(r),o=this._url.replace("{x}",t-a/2).replace("{y}",n/2-i-1).replace("{z}",r).replace("{s}",1).replace("{style}",this._style);return s.ImageryProvider.loadImage(this,o)}}const S="http://mt{s}.google.cn/vt/lyrs=m@207000000&hl=zh-CN&gl=CN&src=app&x={x}&y={y}&z={z}&s=Galile",L="http://mt{s}.google.cn/vt/lyrs=s&hl=zh-CN&x={x}&y={y}&z={z}&s=Gali",P="http://mt{s}.google.cn/vt/lyrs=t@131,r@227000000&hl=zh-CN&gl=cn&x={x}&y={y}&z={z}&s=Galile";class M extends s.UrlTemplateImageryProvider{constructor(t={}){t.url=t.style==="img"?L:t.style==="ter"?P:S,t.subdomains||(t.subdomains=["1","2","3","4","5"]),super(t)}}const I="http://t{s}.tianditu.gov.cn/{layer}_c/wmts?service=WMTS&version=1.0.0&request=GetTile&tilematrix={TileMatrix}&layer={layer}&style={style}&tilerow={TileRow}&tilecol={TileCol}&tilematrixset={TileMatrixSet}&format=tiles&tk={key}";class k extends s.WebMapTileServiceImageryProvider{constructor(t={}){super({url:I.replace(/\{layer\}/g,t.style||"vec").replace(/\{key\}/g,t.key||""),style:"default",format:"tiles",tileMatrixSetID:"c",subdomains:[...Array(6).keys()].map(i=>(i+1).toString()),tileMatrixLabels:[...Array(18).keys()].map(i=>(i+1).toString()),tilingScheme:new s.GeographicTilingScheme,maximumLevel:18})}}const A="https://rt{s}.map.gtimg.com/tile?z={z}&x={x}&y={reverseY}&styleid=1000&scene=0&version=347";class x extends s.UrlTemplateImageryProvider{constructor(t={}){t.url=A,t.subdomains||(t.subdomains=["0","1","2"]),super(t)}}DC.ImageryLayerFactory=class{static createAmapImageryLayer(e){return new D(e)}static createBaiduImageryLayer(e){return new b(e)}static createGoogleImageryLayer(e){return new M(e)}static createTdtImageryLayer(e){return new k(e)}static createTencentImageryLayer(e){return new x(e)}static createArcGisImageryLayer(e){return new s.ArcGisMapServerImageryProvider(e)}static createSingleTileImageryLayer(e){return new s.SingleTileImageryProvider(e)}static createWMTSImageryLayer(e){return new s.WebMapTileServiceImageryProvider(e)}static createXYZImageryLayer(e){return new s.UrlTemplateImageryProvider(e)}static createCoordImageryLayer(e){return new s.TileCoordinatesImageryProvider(e)}};class O extends y{constructor(t){super(),this._viewer=t,this._handler=new s.ScreenSpaceEventHandler(this._viewer.canvas),this._registerEvent(),this.on(s.ScreenSpaceEventType.LEFT_CLICK,this._clickCallback,this),this.on(s.ScreenSpaceEventType.LEFT_DOUBLE_CLICK,this._dbclickCallback,this),this.on(s.ScreenSpaceEventType.RIGHT_CLICK,this._rightClickCallback,this),this.on(s.ScreenSpaceEventType.MOUSE_MOVE,this._mouseMoveCallback,this)}_registerEvent(){for(let t in s.ScreenSpaceEventType){let i=s.ScreenSpaceEventType[t];this._eventCache[i]=new s.Event,this._handler.setInputAction(r=>{this._eventCache[i].raiseEvent(r)},i)}}_getTargetInfo(t){let i,r,a;return t.id&&t.id instanceof s.Entity?(r=t.id.layer,r&&r.getOverlay&&(i=r.getOverlay(t.id.overlayId))):t instanceof s.Cesium3DTileFeature&&(a=t,r=t.tileset.layer,r&&r.getOverlay&&(i=r.getOverlay(t.tileset.overlayId),a.getPropertyNames().forEach(n=>{i.attr[n]=a.getProperty(n)}))),{layer:r,overlay:i,feature:a}}_raiseEvent(t,i,r=null,a=null){let n=!1;if(i){let o=this._getTargetInfo(i),h=o.overlay;if(h&&h.overlayEvent){let g=h.overlayEvent.getEvent(t);g&&g.numberOfListeners>0&&(g.raiseEvent({layer:o.layer,overlay:h,feature:o.feature,position:r,surfacePosition:a}),n=!0)}}if(!n){let o=this._viewer.viewerEvent.getEvent(t);o&&o.numberOfListeners>0&&o.raiseEvent({layer:void 0,overlay:void 0,feature:void 0,position:r,surfacePosition:a})}}_clickCallback(t){if(!t||!t.position)return;let i=this._viewer.scene.pick(t.position),r=this._viewer.scene.pickPosition(t.position);if(!r||!i){let n=this._viewer.scene.camera.getPickRay(t.position);r=this._viewer.scene.globe.pick(n,this._viewer.scene)}let a=this._viewer.scene.camera.pickEllipsoid(t.position,s.Ellipsoid.WGS84);this._raiseEvent(s.ScreenSpaceEventType.LEFT_CLICK,i,r,a)}_dbclickCallback(t){if(!t||!t.position)return;let i=this._viewer.scene.pick(t.position),r=this._viewer.scene.pickPosition(t.position);if(!r||!i){let n=this._viewer.scene.camera.getPickRay(t.position);r=this._viewer.scene.globe.pick(n,this._viewer.scene)}let a=this._viewer.scene.camera.pickEllipsoid(t.position,s.Ellipsoid.WGS84);this._raiseEvent(s.ScreenSpaceEventType.LEFT_DOUBLE_CLICK,i,r,a)}_rightClickCallback(t){if(!t||!t.position)return;let i=this._viewer.scene.pick(t.position),r=this._viewer.scene.pickPosition(t.position);if(!r||!i){let n=this._viewer.scene.camera.getPickRay(t.position);r=this._viewer.scene.globe.pick(n,this._viewer.scene)}let a=this._viewer.scene.camera.pickEllipsoid(t.position,s.Ellipsoid.WGS84);this._raiseEvent(s.ScreenSpaceEventType.RIGHT_CLICK,i,r,a)}_mouseMoveCallback(t){if(!t||!t.endPosition)return;let i=this._viewer.scene.pick(t.endPosition);this._viewer.canvas.style.cursor=i?"pointer":"default";let r=this._viewer.scene.pickPosition(t.endPosition);if(!r||!i){let n=this._viewer.scene.camera.getPickRay(t.endPosition);r=this._viewer.scene.globe.pick(n,this._viewer.scene)}let a=this._viewer.scene.camera.pickEllipsoid(t.endPosition,s.Ellipsoid.WGS84);this._raiseEvent(s.ScreenSpaceEventType.MOUSE_MOVE,i,r,a)}}class R extends y{constructor(){super(),this._registerEvent()}_registerEvent(){for(let t in DC.MouseEventType){let i=DC.MouseEventType[t];this._eventCache[i]=new s.Event}for(let t in DC.ViewerEventType){let i=DC.ViewerEventType[t];this._eventCache[i]=new s.Event}}}class W extends y{constructor(t){super(),this._camera=t.delegate.camera,this._scene=t.delegate.scene,this._clock=t.delegate.clock}on(t,i,r){switch(t){case DC.SceneEventType.CAMERA_MOVE_END:this._camera&&this._camera.moveEnd.addEventListener(i,r||this);break;case DC.SceneEventType.CAMERA_CHANGED:this._camera&&this._camera.changed.addEventListener(i,r||this);break;case DC.SceneEventType.PRE_RENDER:this._scene&&this._scene.preRender.addEventListener(i,r||this);break;case DC.SceneEventType.POST_RENDER:this._scene&&this._scene.postRender.addEventListener(i,r||this);break;case DC.SceneEventType.MORPH_COMPLETE:this._scene&&this._scene.morphComplete.addEventListener(i,r||this);break;case DC.SceneEventType.CLOCK_TICK:this._clock&&this._clock.onTick.addEventListener(i,r||this);break}}off(t,i,r){switch(t){case DC.SceneEventType.CAMERA_MOVE_END:this._camera&&this._camera.moveEnd.removeEventListener(i,r||this);break;case DC.SceneEventType.CAMERA_CHANGED:this._camera&&this._camera.changed.removeEventListener(i,r||this);break;case DC.SceneEventType.PRE_RENDER:this._scene&&this._scene.preRender.removeEventListener(i,r||this);break;case DC.SceneEventType.POST_RENDER:this._scene&&this._scene.postRender.removeEventListener(i,r||this);break;case DC.SceneEventType.MORPH_COMPLETE:this._scene&&this._scene.morphComplete.removeEventListener(i,r||this);break;case DC.SceneEventType.CLOCK_TICK:this._clock&&this._clock.onTick.removeEventListener(i,r||this);break}}}DC.VectorLayer=class extends d{constructor(e){super(e),this._delegate=new s.CustomDataSource(e),this._state=DC.LayerState.INITIALIZED,this.type=DC.LayerType.VECTOR}clear(){return this._cache={},this._delegate.entities&&this._delegate.entities.removeAll(),this._state=DC.LayerState.CLEARED,this}};DC.LayerType.VECTOR="vector";DC.TilesetLayer=class extends d{constructor(e){super(e),this._delegate=new s.PrimitiveCollection,this._state=DC.LayerState.INITIALIZED,this.type=DC.LayerType.TILESET}clear(){return this._cache={},this._delegate.removeAll(),this._state=DC.LayerState.CLEARED,this}};DC.LayerType.TILESET="tileset";DC.GeoJsonLayer=class extends d{constructor(e){super(e),this._state=DC.LayerState.INITIALIZED,this.type=DC.LayerType.GEOJSON}set show(e){this._show=e,this._delegate&&this._delegate.then(t=>{t.show=this._show})}async install(e,t={}){try{if(!e)throw error("the url is empty");const i=await s.GeoJsonDataSource.load(e,t);this._delegate=i}catch(i){console.log("🚀 ~ extends ~ install ~ error:",i)}}get show(){return this._show}_createBillboard(e){if(e.position&&e.billboard)return DC.Billboard.fromEntity(e)}_createPolyline(e){if(e.polyline)return DC.Polyline.fromEntity(e)}_createPolygon(e){if(e.polygon)return DC.Polygon.fromEntity(e)}eachOverlay(e,t){if(this._delegate)return this._delegate.then(i=>{i.entities.values.forEach(r=>{e.call(t,r)})}),this}toVectorLayer(){let e=new DC.VectorLayer(this._id),t=this;return this.eachOverlay(i=>{i.billboard?e.addOverlay(t._createBillboard(i)):i.polyline?e.addOverlay(t._createPolyline(i)):i.polygon&&e.addOverlay(t._createPolygon(i))}),e}center(){const e=this._delegate;console.log("🚀 ~ extends ~ center ~ dataSource:",e);var t=[];return e.entities.values.forEach(function(i){i.polygon&&t.push(i.polygon.hierarchy.getValue(s.JulianDate.now()).positions)}),t.length===0?void 0:s.BoundingSphere.fromPoints(t.flat())}};DC.LayerType.GEOJSON="geojson";const N={size:48,pixelRange:40,gradient:{1e-4:s.Color.BLUE,.001:s.Color.GREEN,.01:s.Color.ORANGE,.1:s.Color.RED},fontSize:14,fontColor:s.Color.BLACK};DC.ClusterLayer=class extends d{constructor(e,t={}){super(e),this._delegate=new s.CustomDataSource(e),this._options={...N,...t},this._delegate.clustering.enabled=!0,this._delegate.clustering.clusterEvent.addEventListener(this._clusterEventHandler,this),this._circleCache={},this._delegate.clustering.pixelRange=this._options.pixelRange,this._state=DC.LayerState.INITIALIZED,this.type=DC.LayerType.CLUSTER}_drawCircle(e){let t=e.toCssColorString(),i=this._options.size;if(!this._circleCache[t]){let r=document.createElement("canvas");r.width=i,r.height=i;let a=r.getContext("2d");a.save(),a.scale(i/24,i/24),a.fillStyle=e.withAlpha(.2).toCssColorString(),a.beginPath(),a.arc(12,12,12,0,2*Math.PI),a.closePath(),a.fill(),a.beginPath(),a.arc(12,12,9,0,2*Math.PI),a.fillStyle=e.toCssColorString(),a.fill(),a.closePath(),a.restore(),this._circleCache[t]=r.toDataURL()}return this._circleCache[t]}_clusterEventHandler(e,t){if(t.billboard.show=!0,t.label.font=`bold ${this._options.fontSize}px sans-serif`,t.label.fillColor=this._options.fontColor,t.label.disableDepthTestDistance=Number.POSITIVE_INFINITY,this._delegate.entities.values.length){let i=this._delegate.entities.values.length||0;for(let r in this._options.gradient)if(e.length>=i*r){t.billboard.image=this._drawCircle(this._options.gradient[r]),t.label.show=!0;let a=(e.length+",").length;t.label.pixelOffset=new s.Cartesian2(-(this._options.size/this._options.fontSize)*(a-1),6)}else e.length<=1&&(t.label.show=!1)}}addOverlays(e){return Array.isArray(e)&&e.forEach(t=>{this.addOverlay(t)}),this}toVectorLayer(){}clear(){return this._cache={},this._delegate.entities.removeAll(),this._state=DC.LayerState.CLEARED,this}};DC.LayerType.CLUSTER="cluster";const C={pixelSize:8,outlineColor:s.Color.BLUE,outlineWidth:2};DC.Point=class extends p{constructor(e){if(!e||!(e instanceof DC.Position))throw new Error("the position invalid");super(),this._position=e,this._delegate=new s.Entity,this._state=DC.OverlayState.INITIALIZED,this.type=DC.OverlayType.POINT}set position(e){if(!e||!(e instanceof DC.Position))throw new Error("the position invalid");this._position=e}get position(){return this._position}_prepareDelegate(){this._delegate.position=new s.CallbackProperty(e=>DC.T.transformWSG84ToCartesian(this._position)),this._delegate.orientation=new s.CallbackProperty(e=>s.Transforms.headingPitchRollQuaternion(DC.T.transformWSG84ToCartesian(this._position),new s.HeadingPitchRoll(s.Math.toRadians(this._position.heading),s.Math.toRadians(this._position.pitch),s.Math.toRadians(this._position.roll)))),this._delegate.point={...C,...this._style},this._delegate.layer=this._layer,this._delegate.overlayId=this._id}setStyle(e){return Object.keys(e).length===0?this:(this._style=e,this._delegate.point&&DC.Util.merge(this._delegate.point,C,this._style),this)}};DC.OverlayType.POINT="point";DC.Polyline=class extends p{constructor(e){if(!e||typeof e!="string"&&!Array.isArray(e))throw new Error("the positions invalid");super(),this._positions=[],this._preparePositions(e),this._delegate=new s.Entity,this._state=DC.OverlayState.INITIALIZED,this.type=DC.OverlayType.POLYLINE}set positions(e){this._preparePositions(e)}get positions(){return this._positions}get center(){let e=s.BoundingSphere.fromPoints(DC.T.transformWSG84ArrayToCartesianArray(this._positions));return DC.T.transformCartesianToWSG84(e.center)}get distance(){let e=0;for(var t=0;t<this._positions.length-1;t++){let i=DC.T.transformWSG84ToCartographic(this._positions[t]),r=DC.T.transformWSG84ToCartographic(this._positions[t+1]),a=new s.EllipsoidGeodesic;a.setEndPoints(i,r);let n=a.surfaceDistance;n=Math.sqrt(Math.pow(n,2)+Math.pow(r.height-i.height,2)),e=e+n}return e>0?e.toFixed(2):e}_preparePositions(e){if(typeof e=="string"){if(e.indexOf("#")>=0)throw new Error("the positions invalid");e=e.split(";")}this._positions=e.map(t=>Array.isArray(t)?DC.Position.fromCoordArray(t):t instanceof DC.Position?t:DC.Position.fromCoordString(t))}_prepareDelegate(){this._delegate.polyline={...this._style,positions:new s.CallbackProperty(e=>DC.T.transformWSG84ArrayToCartesianArray(this._positions))},this._delegate.layer=this._layer,this._delegate.overlayId=this._id}setStyle(e){return Object.keys(e).length==0?this:(this._style=e,this._delegate.polyline&&DC.Util.merge(this._delegate.polyline,this._style),this)}static fromEntity(e){let t;if(e.polyline){let i=GS.T.transformCartesianArrayToWSG84Array(e.polyline.positions.getValue(s.JulianDate.now()));t=new GS.Polyline(i),t.attr={...e.properties}}return t}};DC.OverlayType.POLYLINE="polyline";DC.Circle=class extends p{constructor(e,t){if(!e||!(e instanceof DC.Position))throw new Error("the center invalid");super(),this._center=e,this._radius=t,this._delegate=new s.Entity,this._rotateAmount=0,this._stRotation=0,this._state=DC.OverlayState.INITIALIZED,this.type=DC.OverlayType.CIRCLE}set center(e){if(!e||!(e instanceof DC.Position))throw new Error("the center invalid");this._center=e}get center(){return this._center}set radius(e){this._radius=e}get radius(){return this._redius}set rotateAmount(e){this._rotateAmount=e}get rotateAmount(){return this._rotateAmount}_prepareDelegate(){this._delegate.position=new s.CallbackProperty(e=>DC.T.transformWSG84ToCartesian(this._center)),this._delegate.orientation=new s.CallbackProperty(e=>s.Transforms.headingPitchRollQuaternion(DC.T.transformWSG84ToCartesian(this._center),new s.HeadingPitchRoll(s.Math.toRadians(this._center.heading),s.Math.toRadians(this._center.pitch),s.Math.toRadians(this._center.roll)))),this._delegate.ellipse={...this._style,semiMajorAxis:new s.CallbackProperty(e=>this._radius),semiMinorAxis:new s.CallbackProperty(e=>this._radius),stRotation:new s.CallbackProperty(e=>(this._rotateAmount>0&&(this._stRotation+=this._rotateAmount,this._stRotation===360&&(this._stRotation=0)),this._stRotation))},this._delegate.layer=this._layer,this._delegate.overlayId=this._id}setLabel(e,t){return this._delegate.label={text:e,...t},this}setStyle(e){return Object.keys(e).length===0?this:(this._style=e,this._delegate.ellipse&&DC.Util.merge(this._delegate.ellipse,this._style),this)}};DC.OverlayType.CIRCLE="circle";DC.Label=class extends p{constructor(e,t){if(!e||!(e instanceof DC.Position))throw new Error("the position invalid");super(),this._position=e,this._text=t,this._delegate=new s.Entity,this._state=DC.OverlayState.INITIALIZED,this.type=DC.OverlayType.LABEL}set position(e){if(!e||!(e instanceof DC.Position))throw new Error("the position invalid");this._position=e}get position(){return this._position}set text(e){this._text=text}get text(){return this._text}_prepareDelegate(){this._delegate.position=new s.CallbackProperty(e=>DC.T.transformWSG84ToCartesian(this._position)),this._delegate.orientation=new s.CallbackProperty(e=>s.Transforms.headingPitchRollQuaternion(DC.T.transformWSG84ToCartesian(this._position),new s.HeadingPitchRoll(s.Math.toRadians(this._position.heading),s.Math.toRadians(this._position.pitch),s.Math.toRadians(this._position.roll)))),this._delegate.label={...this._style,text:new s.CallbackProperty(e=>this._text)},this._delegate.layer=this._layer,this._delegate.overlayId=this._id}setStyle(e){return Object.keys(e).length===0?this:(this._style=e,this._delegate.label&&DC.Util.merge(this._delegate.label,this._style),this)}};DC.OverlayType.LABEL="label";DC.Plane=class extends p{constructor(e,t,i,r){if(!e||!(e instanceof DC.Position))throw new Error("the position invalid");super(),this._position=e,this._width=t,this._height=i,this._plane=new s.Plane(s.Cartesian3.clone(r),0),this._delegate=new s.Entity,this._state=DC.OverlayState.INITIALIZED,this.type=DC.OverlayType.PLANE}set position(e){!e||!(e instanceof DC.Position)||(this._position=e)}get position(){return this._position}set width(e){this._width=e}get width(){return this._width}set height(e){this._height=e}get height(){return this._height}set direction(e){this._plane=new s.Plane(e,0)}_prepareDelegate(){this._delegate.position=new s.CallbackProperty(e=>DC.T.transformWSG84ToCartesian(this._position)),this._delegate.orientation=new s.CallbackProperty(e=>s.Transforms.headingPitchRollQuaternion(DC.T.transformWSG84ToCartesian(this._center),new s.HeadingPitchRoll(s.Math.toRadians(this._position.heading),s.Math.toRadians(this._position.pitch),s.Math.toRadians(this._position.roll)))),this._delegate.plane={...this._style,plane:new s.CallbackProperty(e=>this._plane),dimensions:new s.CallbackProperty(e=>({x:this._width,y:this._height}))},this._delegate.layer=this._layer,this._delegate.overlayId=this._id}setStyle(e){return Object.keys(e).length===0?this:(this._style=e,this._delegate.plane&&DC.Util.merge(this._delegate.plane,this._style),this)}};DC.OverlayType.PLANE="plane";DC.Model=class extends p{constructor(e,t){if(!e||!(e instanceof DC.Position))throw new Error("the position invalid");super(),this._position=e,this._modelUrl=t,this._delegate=new s.Entity,this._state=DC.OverlayState.INITIALIZED,this._rotateAmount=0,this.type=DC.OverlayType.MODEL}set position(e){if(!e||!(e instanceof DC.Position))throw new Error("the position invalid");this._position=e}get position(){return this._position}set modelUrl(e){this._modelUrl=e}get modelUrl(){return this._modelUrl}set rotateAmount(e){this._rotateAmount=e}get rotateAmount(){return this._rotateAmount}_prepareDelegate(){this._delegate.position=new s.CallbackProperty(e=>DC.T.transformWSG84ToCartesian(this._position)),this._delegate.orientation=new s.CallbackProperty(e=>(this._rotateAmount>0&&(this._position.heading+=this._rotateAmount,this._position.heading===360&&(this._position.heading=0)),s.Transforms.headingPitchRollQuaternion(DC.T.transformWSG84ToCartesian(this._position),new s.HeadingPitchRoll(s.Math.toRadians(this._position.heading),s.Math.toRadians(this._position.pitch),s.Math.toRadians(this._position.roll))))),this._delegate.model={...this._style,uri:new s.CallbackProperty(e=>this._modelUrl)},this._delegate.layer=this._layer,this._delegate.overlayId=this._id}setLabel(e,t){return this._delegate.label={...t,text:e},this}setStyle(e){if(Object.keys(e).length==0)return this;this._style=e,this._delegate.model&&DC.Util.merge(this._delegate.model,this._style)}};DC.OverlayType.MODEL="model";DC.Tileset=class extends p{constructor(e,t={}){super(),this._state=DC.OverlayState.INITIALIZED,this._height=void 0,this._properties=void 0,this._stopTime=void 0,this._duration=void 0,this._center=void 0,this.type=DC.OverlayType.TILESET}async install(e,t={}){try{this._delegate=await s.Cesium3DTileset.fromUrl(e,t),this._delegate.tileVisible.addEventListener(this._tileVisibleHandler,this)}catch(i){console.log("🚀 ~ extends ~ install ~ error:",i)}}_addCallback(e){this._layer=e,this._layer.delegate.add(this._delegate),this._delegate.layer=this._layer,this._delegate.overlayId=this._id,this._state=DC.OverlayState.ADDED}_removeCallback(){this._layer&&(this._layer.delegate.remove(this._delegate),this._state=DC.OverlayState.REMOVED)}_tileVisibleHandler(e){this._updateProperties(e),this._updateHeight(e)}_updateProperties(e){if(this._properties&&this._properties.length){let t=e.content;for(let i=0;i<t.featuresLength;i++){let r=t.getFeature(i);this._properties.forEach(a=>{r.hasProperty(a.key)&&r.getProperty(a.key)===a.keyValue&&r.setProperty(a.propertyName,a.propertyValue)})}this._properties=[]}}_updateHeight(e){if(this._duration){let t=this._height/this._duration,i=s.JulianDate.now();this._stopTime&&s.JulianDate.greaterThan(this._stopTime,i)&&this._setHeight((this._duration-s.JulianDate.secondsDifference(this._stopTime,i))*t)}}_setHeight(e){const t=this._delegate;let i=s.Cartesian3.fromRadians(this._center.longitude,this._center.latitude,this._center.height),r=s.Cartesian3.fromRadians(this._center.longitude,this._center.latitude,this._center.height+e),a=s.Cartesian3.subtract(r,i,new s.Cartesian3);t.modelMatrix=s.Matrix4.fromTranslation(a)}setPosition(e){if(!e||!e instanceof DC.Position)return this;const t=this._delegate;let i=s.Transforms.eastNorthUpToFixedFrame(s.Cartesian3.fromDegrees(e.lng,e.lat,e.alt)),r=s.Matrix4.fromRotationTranslation(s.Matrix3.fromRotationZ(s.Math.toRadians(e.heading)));return s.Matrix4.multiply(i,r,i),t.root.transform=i,this}setHeight(e,t){this._height=e;const i=this._delegate;return this._center=s.Cartographic.fromCartesian(i.boundingSphere.center),t?(this._duration=t,this._stopTime=s.JulianDate.addSeconds(s.JulianDate.now(),t,new s.JulianDate)):this._setHeight(this._height),this}setScale(e){const t=this._delegate;let i=t.root.transform;e>0&&e!==1&&s.Matrix4.multiplyByUniformScale(i,e,i),t.root.transform=i}setFeatureProperty(e){return this._properties=e,this}setStyle(e){return e&&e instanceof s.Cesium3DTileStyle&&(this._style=e,this._delegate&&(this._delegate.style=this._style)),this}};DC.OverlayType.TILESET="tileset";DC.Position=class{constructor(e,t,i=0,r=0,a=0,n=0){this._lng=e,this._lat=t,this._alt=i,this._heading=r,this._pitch=a,this._roll=n}set lng(e){this._lng=e}get lng(){return this._lng}set lat(e){this._lat=e}get lat(){return this._lat}set alt(e){this._alt=e}get alt(){return this._alt}set heading(e){this._heading=e}get heading(){return this._heading}set pitch(e){this._pitch=e}get pitch(){return this._pitch}set roll(e){this._roll=e}get roll(){return this._roll}serialize(){let e=new DC.Position(this._lng,this._lat,this._alt,this._heading,this._pitch,this._roll);return JSON.stringify(e)}static copy(e){let t=new DC.Position;return e&&(t.lng=e.lng||0,t.lat=e.lat||0,t.alt=e.alt||0,t.heading=e.heading||0,t.pitch=e.pitch||0,t.roll=e.roll||0),t}static deserialize(e){let t=new DC.Position,i=JSON.parse(e);return i&&(t.lng=i.lng||0,t.lat=i.lat||0,t.alt=i.alt||0,t.heading=i.heading||0,t.pitch=i.pitch||0,t.roll=i.roll||0),t}static fromCoordString(e){let t=new DC.Position;if(e&&typeof e=="string"){let i=e.split(",");i&&i.length&&(t.lng=i[0]||0,t.lat=i[1]||0,t.alt=i[2]||0)}return t}static fromCoordArray(e){let t=new DC.Position;return Array.isArray(e)&&(t.lng=e[0]||0,t.lat=e[1]||0,t.alt=e[2]||0),t}};DC.T=class{static transformCartesianToWSG84(e){if(e){let t=s.Ellipsoid.WGS84.cartesianToCartographic(e);return new DC.Position(s.Math.toDegrees(t.longitude),s.Math.toDegrees(t.latitude),t.height)}return new DC.Position(0,0)}static transformWSG84ToCartesian(e){return e?s.Cartesian3.fromDegrees(e.lng,e.lat,e.alt):s.Cartesian3.ZERO}static transformWSG84ToCartographic(e){return e?s.Cartographic.fromDegrees(e.lng,e.lat,e.alt):s.Cartographic.ZERO}static transformCartesianArrayToWSG84Array(e){return e?e.map(t=>DC.T.transformCartesianToWSG84(t)):[]}static transformWSG84ArrayToCartesianArray(e){return e?e.map(t=>DC.T.transformWSG84ToCartesian(t)):[]}};class V{constructor(t){this._viewer=t,this._init()}_init(){this._viewer.delegate.cesiumWidget._creditContainer.style.display="none",this._viewer.delegate.cesiumWidget.screenSpaceEventHandler.removeInputAction(s.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),this._viewer.delegate.scene.screenSpaceCameraController.maximumZoomDistance=40489014,this._viewer.delegate.scene.backgroundColor=s.Color.TRANSPARENT,this._viewer.delegate.scene.postProcessStages.fxaa.enabled=!0,this._viewer.delegate.imageryLayers.removeAll()}_setViewerOption(t){return this._viewer.delegate.shadows=s.defaultValue(t.shadows,!1),this}_setCanvasOption(t){return t.tabIndex&&this._viewer.delegate.scene.canvas.setAttribute("tabIndex",t.tabIndex),this}_setSceneOption(t){return this._viewer.delegate.scene.skyAtmosphere.show=s.defaultValue(t.showAtmosphere,!0),this._viewer.delegate.scene.sun.show=s.defaultValue(t.showSun,!0),this._viewer.delegate.scene.moon.show=s.defaultValue(t.showMoon,!0),this._viewer.delegate.scene.skyBox.show=s.defaultValue(t.showSkyBox,!0),this._viewer.delegate.scene.postProcessStages.fxaa.enabled=s.defaultValue(t.enableFxaa,!1),this._viewer.delegate.scene.screenSpaceCameraController.enableRotate=s.defaultValue(t.enableRotate,!0),this._viewer.delegate.scene.screenSpaceCameraController.enableTilt=s.defaultValue(t.enableTilt,!0),this._viewer.delegate.scene.screenSpaceCameraController.enableTranslate=s.defaultValue(t.enableTranslate,!0),this._viewer.delegate.scene.screenSpaceCameraController.enableZoom=s.defaultValue(t.enableZoom,!0),this._viewer.delegate.scene.screenSpaceCameraController.maximumZoomDistance=s.defaultValue(t.maxZoomDistance,40489014),this._viewer.delegate.scene.screenSpaceCameraController.minimumZoomDistance=s.defaultValue(t.minZoomDistance,1),this}_setGlobeOption(t){return this._viewer.delegate.scene.globe.show=s.defaultValue(t.showGlobe,!0),this._viewer.delegate.scene.globe.enableLighting=s.defaultValue(t.enableLighting,!1),this._viewer.delegate.scene.globe.depthTestAgainstTerrain=s.defaultValue(t.underground,!1),this}_setClockOption(t){return this._viewer.delegate.clock.shouldAnimate=s.defaultValue(t.shouldAnimate,!0),this}setOptions(t){return this._setViewerOption(t)._setCanvasOption(t)._setSceneOption(t)._setGlobeOption(t)._setClockOption(t),this}}class H{constructor(t){this._viewer=t}setPichRange(t,i){let r=new s.ScreenSpaceEventHandler(this._viewer.scene.canvas);this._viewer.scene.mode===s.SceneMode.SCENE3D&&(r.setInputAction(a=>{r.setInputAction(n=>{let o=!0,h=n.endPosition.y<n.startPosition.y;h&&this._viewer.camera.pitch>s.Math.toRadians(i)||!h&&this._viewer.camera.pitch<s.Math.toRadians(t)?o=!1:o=!0,this._viewer.scene.screenSpaceCameraController.enableTilt=o},s.ScreenSpaceEventType.MOUSE_MOVE)},s.ScreenSpaceEventType.MIDDLE_DOWN),r.setInputAction(a=>{this._viewer.scene.screenSpaceCameraController.enableTilt=!0,r.removeInputAction(s.ScreenSpaceEventType.MOUSE_MOVE)},s.ScreenSpaceEventType.MIDDLE_UP))}limitCameraToGround(){this._viewer.camera.changed.addEventListener(t=>{this._viewer.camera._suspendTerrainAdjustment&&this._viewer.scene.mode===s.SceneMode.SCENE3D&&(this._viewer.camera._suspendTerrainAdjustment=!1,this._viewer.camera._adjustOrthographicFrustum(!0))})}}class c{constructor(){this._viewer=void 0,this._position=void 0,this._enable=!1,this._wapper=void 0,this._positionChangeAble=!1,this._state=DC.WidgetState.INSTALLED,this.type=void 0}set enable(t){this._enable=t,this._state=this._enable?DC.WidgetState.ENABLED:DC.WidgetState.DISABLED,this._enableHook&&this._enableHook()}get enable(){return this._enable}get state(){return this._state}_enableHook(){!this._wapper.parentNode&&this._viewer&&this._wapper&&this._viewer.dcContainer.appendChild(this._wapper),this._wapper&&(this._wapper.style.visibility=this._enable?"visible":"hidden")}_updateWindowCoord(t){}install(t){if(this._viewer=t,this._state=DC.WidgetState.INSTALLED,this._viewer&&this._wapper&&this._positionChangeAble){let i=this,r=this._viewer.scene;r.postRender.addEventListener(()=>{if(i._position&&i._enable&&i._updateWindowCoord&&i._wapper.style.visibility==="visible"){let a=s.SceneTransforms.wgs84ToWindowCoordinates(r,i._position);a&&i._updateWindowCoord(a)}})}this._installHook&&this._installHook()}setPosition(t){return this._position=t,this._wapper&&(this._wapper.style.cssText=`
    visibility:visible;
    `),this}setContent(t){return t&&typeof t=="string"?this._wapper.innerHTML=t:t&&t instanceof Element&&this._wapper.appendChild(t),this}hide(){this._wapper&&(this._wapper.style.cssText=`
    visibility:hidden;
    `)}}class G extends c{constructor(){super(),this._wapper=DC.DomUtil.create("div","dc-attribution"),this._wapper.style.cssText=`
      position: absolute;
      left: 2px;
      bottom: 2px;
      font-size: 14px;
      color: rgb(255, 255, 255);
      background: rgba(0,0,0,0.6);
      padding: 2px 5px;
      border-radius: 2px;
      user-select: none;
      box-shadow: 2px 2px 3px #2b2b2b;
    `,this._config=void 0,this.type=DC.WidgetType.ATTRIBUTION}_installHook(){this.enable=!0}}DC.WidgetType.ATTRIBUTION="attribution";class U extends c{constructor(){super(),this._wapper=DC.DomUtil.create("div","dc-context-menu"),this._ulEl=DC.DomUtil.create("ul","menu-list",this._wapper),this._config={},this._positionChangeAble=!0,this.type=DC.WidgetType.CONTEXT_MENU}_installHook(){this._viewer&&(this._viewer.on(DC.MouseEventType.RIGHT_CLICK,this._rightclickHandler,this),this._viewer.on(DC.MouseEventType.CLICK,this._clickHandler,this)),this._prepareDefaultMenu()}_prepareDefaultMenu(){let t=DC.DomUtil.create("li","menu-item",this._ulEl);t.innerHTML="飞到默认位置";let i=this;t.onclick=()=>{i._viewer.delegate.camera.flyHome(0),i.hide()}}_rightclickHandler(t){t&&t.position&&this._enable&&this._updateWindowCoord&&this._updateWindowCoord(s.SceneTransforms.wgs84ToWindowCoordinates(this._viewer.delegate.scene,t.position))}_clickHandler(t){this.hide()}_updateWindowCoord(t){this._wapper.style.cssText=`
    visibility:visible;
    z-index:1;
    transform:translate3d(${Math.round(t.x)}px,${Math.round(t.y)}px, 0);
    `}_setCustomClass(){DC.DomUtil.setClass(this._wapper,`dc-context-menu ${this._config.customClass}`)}set config(t){this._config=t,t.customClass&&this._setCustomClass()}addMenuItem(t,i,r){if(!t||!i)return this;let a=DC.DomUtil.create("li","menu-item"),n=this._ulEl.lastChild;a.innerHTML=t;let o=this;return i&&(a.onclick=()=>{i.call(r),o.hide()}),this._ulEl.insertBefore(a,n),this}}DC.WidgetType.CONTEXT_MENU="contextmenu";class B extends c{constructor(){super(),this._wapper=DC.DomUtil.create("div","dc-location-bar"),this._mouseEl=DC.DomUtil.create("div","mouse-location",this._wapper),this._cameraEl=DC.DomUtil.create("div","camera-location",this._wapper)}_installHook(){this._viewer.on(DC.MouseEventType.MOUSE_MOVE,this._moveHandler,this),this._viewer.on(DC.SceneEventType.CAMERA_CHANGED,this._cameraHandler,this)}_moveHandler(t){this._enable}_cameraHandler(t){this._enable}}DC.WidgetType.LOCATION_BAR="locationBar";class z extends c{constructor(){super(),this._wapper=DC.DomUtil.create("div","dc-slider"),this._baseLayer=void 0,this._moveActive=!1}_installHook(){let t=new s.ScreenSpaceEventHandler(this._wapper),i=this;t.setInputAction(()=>{i._moveActive=!0},s.ScreenSpaceEventType.LEFT_DOWN),t.setInputAction(()=>{i._moveActive=!0},s.ScreenSpaceEventType.PINCH_START),t.setInputAction(r=>{i._moveHandler(r)},s.ScreenSpaceEventType.MOUSE_MOVE),t.setInputAction(r=>{i._moveHandler(r)},s.ScreenSpaceEventType.PINCH_MOVE),t.setInputAction(()=>{i._moveActive=!1},s.ScreenSpaceEventType.LEFT_UP),t.setInputAction(()=>{i._moveActive=!1},s.ScreenSpaceEventType.PINCH_END)}_moveHandler(t){if(!this._moveActive||!this._enable)return;let i=t.endPosition.x,r=(this._wapper.offsetLeft+i)/this._wapper.parentElement.offsetWidth;this._wapper.style.left=100*r+"%",this._viewer.scene.imagerySplitPosition=r}addBaseLayer(t,i){return!this._viewer||!this._enable?this:(t&&(this._baseLayer&&this._viewer.delegate.imageryLayers.remove(this._baseLayer),this._baseLayer=this._viewer.delegate.imageryLayers.addImageryProvider(t),this._baseLayer.splitDirection=i||0,this._viewer.scene.imagerySplitPosition=this._wapper.offsetLeft/this._wapper.parentElement.offsetWidth),this)}}DC.WidgetType.MAPSPLIT="mapsplit";class F extends c{constructor(){super(),this._wapper=DC.DomUtil.create("div","dc-map-switch"),this._config=void 0,this._cache=[],this.type=DC.WidgetType.MAPSWITCH}_enableHook(){!this._wapper.parentNode&&this._viewer&&this._wapper&&this._viewer.dcContainer.appendChild(this._wapper)}_installHook(){this.enable=!0;let t=this;this._wapper.onmouseover=()=>{let i=80;t._cache.length>0&&(i=t._cache.length*85.7),this._wapper.style.width=`${i}px`},this._wapper.onmouseout=()=>{t._wapper.style.width="80px"}}_addItem(t){let i=DC.DomUtil.create("div","map-item",this._wapper),r=this._cache.length?this._cache.length-1:0;i.setAttribute("data-index",r),i.onclick=n=>{let o=document.getElementsByClassName("map-item active");o&&o.length&&(o[0].className="map-item"),this._viewer&&(n.target.className="map-item active",this._viewer.changeBaseLayer(Number(n.target.getAttribute("data-index")||0)))},t.iconUrl&&(i.style.cssText=`
       background:url(${t.iconUrl});
    `);let a=DC.DomUtil.create("span","",i);a.innerHTML=t.name||"地图"}addMap(t={}){this._enable&&(this._cache.push(t),this._addItem(t),this._cache.length>1&&(this._wapper.style.visibility="visible"))}}DC.WidgetType.MAPSWITCH="mapswitch";class Z extends c{constructor(){super(),this._wapper=DC.DomUtil.create("div","dc-popup"),this._config=void 0,this._positionChangeAble=!0,this.type=DC.WidgetType.POPUP}_installHook(){this.enable=!0}_updateWindowCoord(t){let i=t.x,r=t.y;this._config&&(this._wapper.style.cssText=`
        position: absolute;
        visibility:visible;
        z-index:1;
        left: ${i}px;
        top:${r}px
      `)}_setCustomClass(){DC.DomUtil.setClass(this._wapper,`dc-popup ${this._config.customClass}`)}set config(t){this._config=t,t.customClass&&this._setCustomClass()}}DC.WidgetType.POPUP="popup";class j extends c{constructor(){super(),this._wapper=DC.DomUtil.create("div","dc-tool-tip"),this._positionChangeAble=!0,this.type=DC.WidgetType.TOOLTIP}_updateWindowCoord(t){let i=t.x+10,r=t.y-this._wapper.offsetHeight/2;this._wapper.style.cssText=`
    visibility:visible;
    z-index:1;
    transform:translate3d(${Math.round(i)}px,${Math.round(r)}px, 0);
    `}}DC.WidgetType.TOOLTIP="tooltip";const J={animation:!1,baseLayerPicker:!1,fullscreenButton:!1,geocoder:!1,homeButton:!1,infoBox:!1,sceneModePicker:!1,selectionIndicator:!1,timeline:!1,navigationHelpButton:!1,navigationInstructionsInitiallyVisible:!1,creditContainer:void 0};class K extends c{constructor(){super(),this._wapper=DC.DomUtil.create("div","dc-hawkeye-map"),this._wapper.setAttribute("id",DC.Util.uuid()),this._baseLayer=void 0,this._delegate=void 0,this.type=DC.WidgetType.HAWkEYEMAP}_prepareDelegate(){this._delegate=new s.Viewer(this._wapper,{...J,sceneMode:s.SceneMode.SCENE2D}),this._delegate.scene.screenSpaceCameraController.enableRotate=!1,this._delegate.scene.screenSpaceCameraController.enableTranslate=!1,this._delegate.scene.screenSpaceCameraController.enableZoom=!1,this._delegate.scene.screenSpaceCameraController.enableTilt=!1,this._delegate.scene.screenSpaceCameraController.enableLook=!1,this._delegate.cesiumWidget._creditContainer.style.display="none",this._delegate.cesiumWidget.screenSpaceEventHandler.removeInputAction(s.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),this._delegate.scene.screenSpaceCameraController.maximumZoomDistance=40489014,this._delegate.scene.backgroundColor=s.Color.TRANSPARENT,this._delegate.scene.postProcessStages.fxaa.enabled=!0,this._delegate.imageryLayers.removeAll()}_installHook(){this._prepareDelegate(),this._viewer.camera.changed.addEventListener(this._sync2DView,this),this._viewer.camera.percentageChanged=.01}_sync2DView(){let t=new s.Cartesian2(Math.floor(this._viewer.canvas.clientWidth/2),Math.floor(this._viewer.canvas.clientHeight/2)),i=this._viewer.scene.camera.pickEllipsoid(t);if(!i)return!1;let r=s.Cartesian3.distance(i,this._viewer.scene.camera.positionWC);this._delegate.scene.camera.lookAt(i,new s.Cartesian3(0,0,r))}addBaseLayer(t){return!this._delegate||!this._enable?this:(t&&(this._baseLayer&&this._delegate.imageryLayers.remove(this._baseLayer),this._baseLayer=this._delegate.imageryLayers.addImageryProvider(t)),this)}}DC.WidgetType.HAWkEYEMAP="hawkeyeMap";const Y={animation:!1,fullscreenButton:!1,geocoder:!1,homeButton:!1,infoBox:!1,sceneModePicker:!1,selectionIndicator:!1,timeline:!1,navigationHelpButton:!1,navigationInstructionsInitiallyVisible:!1,creditContainer:void 0,shouldAnimate:!0,baseLayerPicker:!1,orderIndependentTranslucency:!1,contextOptions:{webgl:{alpha:!0}}};DC.Viewer=class{constructor(e,t={}){if(!e||!document.getElementById(e))throw new Error("the id is empty");this._delegate=new s.Viewer(e,{...t,...Y}),new O(this),this._viewerOption=new V(this),this._cameraOption=new H(this),this._viewerEvent=new R,this._sceneEvent=new W(this),this._dcContainer=DC.DomUtil.create("div","dc-container",document.getElementById(e)),this._baseLayerPicker=new s.BaseLayerPickerViewModel({globe:this._delegate.scene.globe}),this._layerCache={},this._effectCache={},this.on(DC.ViewerEventType.ADD_LAYER,this._addLayerCallback,this),this.on(DC.ViewerEventType.REMOVE_LAYER,this._removeLayerCallback,this),this.on(DC.ViewerEventType.ADD_EFFECT,this._addEffectCallback,this),this.on(DC.ViewerEventType.REMOVE_EFFECT,this._removeEffectCallback,this),this._comps={popup:new Z,contextMenu:new U,tooltip:new j,mapSwitch:new F,mapSplit:new z,locationBar:new B,hawkeyeMap:new K};for(let i in this._comps)this.use(this._comps[i]);this.use(new G)}get delegate(){return this._delegate}get dcContainer(){return this._dcContainer}get scene(){return this._delegate.scene}get camera(){return this._delegate.camera}get canvas(){return this._delegate.scene.canvas}get clock(){return this._delegate.clock}get viewerEvent(){return this._viewerEvent}get popup(){return this._comps.popup}get contextMenu(){return this._comps.contextMenu}get tooltip(){return this._comps.tooltip}get mapSplit(){return this._comps.mapSplit}get mapSwitch(){return this._comps.mapSwitch}get locationBar(){return this._comps.locationBar}get hawkeyeMap(){return this._comps.hawkeyeMap}get cameraPosition(){let e=DC.T.transformCartesianToWSG84(this.camera.positionWC);return e&&(e.heading=s.Math.toDegrees(this.camera.heading),e.pitch=s.Math.toDegrees(this.camera.pitch),e.roll=s.Math.toDegrees(this.camera.roll)),e}_addLayerCallback(e){console.log("🚀 ~ _addLayerCallback ~ layer:",e.layerEvent),e&&e.layerEvent&&e.state!==DC.LayerState.ADDED&&(!this._layerCache[e.type]&&(this._layerCache[e.type]={}),e.layerEvent.fire(DC.LayerEventType.ADD,this),this._layerCache[e.type][e.id]=e)}_removeLayerCallback(e){e&&e.layerEvent&&e.state!==DC.LayerState.REMOVED&&(e.layerEvent.fire(DC.LayerEventType.REMOVE,this),this._layerCache[e.type]&&this._layerCache[e.type][e.id]&&delete this._layerCache[e.type][e.id])}_addEffectCallback(e){e&&e.effectEvent&&e.state!==DC.EffectState.ADDED&&(!this._effectCache[e.type]&&(this._effectCache[e.type]={}),e.effectEvent.fire(DC.EffectEventType.ADD,this),this._effectCache[e.type][e.id]=e)}_removeEffectCallback(e){e&&e.effectEvent&&e.state!==DC.EffectState.REMOVED&&(e.effectEvent.fire(DC.EffectEventType.REMOVE,this),this._effectCache[e.type]&&this._effectCache[e.type][e.id]&&delete this._effectCache[e.type][e.id])}setOptions(e){return this._viewerOption.setOptions(e),this}setPitchRange(e=-90,t=-20){return this._cameraOption.setPichRange(e,t),this}limitCameraToGround(){return this._cameraOption.limitCameraToGround(),this}changeMode(e,t=0){return e===2?this._delegate.scene.morphTo2D(t):e===3?this._delegate.scene.morphTo3D(t):e===2.5&&this._delegate.scene.morphToColumbusView(t),this}addBaseLayer(e,t={}){return e?(this._baseLayerPicker.imageryProviderViewModels.push(new s.ProviderViewModel({name:t.name||"地图",creationFunction:()=>e})),this._baseLayerPicker.selectedImagery||(this._baseLayerPicker.selectedImagery=this._baseLayerPicker.imageryProviderViewModels[0]),this._comps.mapSwitch.addMap(t),this):this}changeBaseLayer(e){return this._baseLayerPicker&&e>=0&&(this._baseLayerPicker.selectedImagery=this._baseLayerPicker.imageryProviderViewModels[e]),this}addTerrain(e){if(!e)return this;this._baseLayerPicker.terrainProviderViewModels.push(new s.ProviderViewModel({name:"地形",creationFunction:()=>e})),this._baseLayerPicker.selectedTerrain||(this._baseLayerPicker.selectedTerrain=this._baseLayerPicker.terrainProviderViewModels[0])}changeTerrain(e){return this._baseLayerPicker&&e>=0&&(this._baseLayerPicker.selectedTerrain=this._baseLayerPicker.terrainProviderViewModels[e]),this}addLayer(e){return this._viewerEvent.fire(DC.ViewerEventType.ADD_LAYER,e),this}removeLayer(e){return this._viewerEvent.fire(DC.ViewerEventType.REMOVE_LAYER,e),this}getLayer(e){let t;for(let i in this._layerCache){let r=this._layerCache[i];for(let a in r)if(a===e){t=r[a];break}if(t)break}return t}getLayers(){let e=[];for(let t in this._layerCache){let i=this._layerCache[t];for(let r in i)e.push(i[r])}return e}eachLayer(e,t){for(let i in this._layerCache){let r=this._layerCache[i];for(let a in r)e.call(t,r[a])}return this}addEffect(e){return this._viewerEvent.fire(DC.ViewerEventType.ADD_EFFECT,e),this}removeEffect(e){return this._viewerEvent.fire(DC.ViewerEventType.REMOVE_EFFECT,e),this}flyTo(e){return console.log("🚀 ~ flyTo ~ target:",e),this._delegate.flyTo(e.delegate||e),this}zoomTo(e){return this._delegate.zoomTo(e.delegate||e),this}flyToPosition(e,t,i){return e instanceof DC.Position&&this._delegate.camera.flyTo({destination:DC.T.transformWSG84ToCartesian(e),orientation:{heading:s.Math.toRadians(e.heading),pitch:s.Math.toRadians(e.pitch),roll:s.Math.toRadians(e.roll)},complete:t,duration:i}),this}on(e,t,i){return this._viewerEvent.on(e,t,i||this),this._sceneEvent.on(e,t,i||this),this}off(e,t,i){return this._viewerEvent.off(e,t,i||this),this._sceneEvent.off(e,t,i||this),this}use(e){return e&&e.install&&e.install(this),this}};
